!function(e){function t(o){if(n[o])return n[o].exports;var r=n[o]={exports:{},id:o,loaded:!1};return e[o].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){var o=n(1);window.Powerbi=o.PowerBi,window.powerbi=new o.PowerBi},function(e,t,n){var o=n(2),r=n(4),i=n(5),s=n(3),a=function(){function e(t){void 0===t&&(t={}),this.embeds=[],window.addEventListener("message",this.onReceiveMessage.bind(this),!1),this.config=s.Utils.assign({},e.defaultConfig,t),this.config.autoEmbedOnContentLoaded&&this.enableAutoEmbed()}return e.prototype.init=function(e){var t=this;e=e&&e instanceof HTMLElement?e:document.body;var n=Array.prototype.slice.call(e.querySelectorAll("["+o.Embed.embedUrlAttribute+"]"));n.forEach(function(e){return t.embed(e)})},e.prototype.embed=function(e,t){void 0===t&&(t={});var n,o=e;return n=o.powerBiEmbed?this.embedExisting(o,t):this.embedNew(o,t)},e.prototype.embedNew=function(t,n){var i=this,a=n.type||t.getAttribute(o.Embed.typeAttribute);if(!a)throw new Error("Attempted to embed using config "+JSON.stringify(n)+" on element "+t.outerHTML+", but could not determine what type of component to embed. You must specify a type in the configuration or as an attribute such as '"+o.Embed.typeAttribute+'="'+r.Report.name.toLowerCase()+"\"'.");n.type=a;var c=s.Utils.find(function(e){return a===e.name.toLowerCase()},e.components);if(!c)throw new Error("Attempted to embed component of type: "+a+" but did not find any matching component.  Please verify the type you specified is intended.");n.getGlobalAccessToken=function(){return i.accessToken};var l=new c(t,n);return t.powerBiEmbed=l,this.embeds.push(l),l},e.prototype.embedExisting=function(e,t){var n=s.Utils.find(function(t){return t.element===e},this.embeds);if(!n)throw new Error("Attempted to embed using config "+JSON.stringify(t)+" on element "+e.outerHTML+" which already has embedded comopnent associated, but could not find the existing comopnent in the list of active components. This could indicate the embeds list is out of sync with the DOM, or the component is referencing the incorrect HTML element.");return n.load(t,!0),n},e.prototype.enableAutoEmbed=function(){var e=this;window.addEventListener("DOMContentLoaded",function(t){return e.init(document.body)},!1)},e.prototype.get=function(e){var t=e;if(!t.powerBiEmbed)throw new Error("You attempted to get an instance of powerbi component associated with element: "+e.outerHTML+" but there was no associated instance.");return t.powerBiEmbed},e.prototype.reset=function(e){var t=e;if(t.powerBiEmbed){s.Utils.remove(function(e){return e===t.powerBiEmbed},this.embeds),delete t.powerBiEmbed;var n=e.querySelector("iframe");n&&n.remove()}},e.prototype.onReceiveMessage=function(t){if(t)try{var n=s.Utils.find(function(e){return t.source===e.iframe.contentWindow},this.embeds);if(n){var o="string"==typeof t.data?JSON.parse(t.data):t.data;s.Utils.raiseCustomEvent(n.element,e.eventMap[o.event],o)}}catch(r){if("function"!=typeof this.config.onError)throw r;this.config.onError.call(window,r)}},e.components=[i.Tile,r.Report],e.eventMap={tileClicked:"tile-click",tileLoaded:"tile-load",reportPageLoaded:"report-load"},e.defaultConfig={autoEmbedOnContentLoaded:!1,onError:function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];return console.log(e[0],e.slice(1))}},e}();t.PowerBi=a},function(e,t,n){var o=n(3),r=function(){function e(t,n){var r=this;this.element=t,this.options=o.Utils.assign({},e.defaultOptions,n),this.options.accessToken=this.getAccessToken(),this.options.embedUrl=this.getEmbedUrl();var i='<iframe style="width:100%;height:100%;" src="'+this.options.embedUrl+'" scrolling="no" allowfullscreen="true"></iframe>';this.element.innerHTML=i,this.iframe=this.element.childNodes[0],this.iframe.addEventListener("load",function(){return r.load(r.options,!1)},!1)}return e.prototype.load=function(e,t,n){if(void 0===t&&(t=!1),void 0===n&&(n=null),!n)throw new Error("You called load without providing message properties from the concrete embeddable class.");var r={accessToken:e.accessToken};o.Utils.assign(n,r);var i={message:n};o.Utils.raiseCustomEvent(this.element,i.message.action,i),this.iframe.contentWindow.postMessage(JSON.stringify(i.message),"*")},e.prototype.getAccessToken=function(){var t=this.options.accessToken||this.element.getAttribute(e.accessTokenAttribute)||this.options.getGlobalAccessToken();if(!t)throw new Error("No access token was found for element. You must specify an access token directly on the element using attribute '"+e.accessTokenAttribute+"' or specify a global token at: powerbi.accessToken.");return t},e.prototype.getEmbedUrl=function(){var t=this.options.embedUrl||this.element.getAttribute(e.embedUrlAttribute);if("string"!=typeof t||0===t.length)throw new Error("Embed Url is required, but it was not found. You must provide an embed url either as part of embed configuration or as attribute '"+e.embedUrlAttribute+"'.");return t},e.prototype.fullscreen=function(){var e=this.iframe.requestFullscreen||this.iframe.msRequestFullscreen||this.iframe.mozRequestFullScreen||this.iframe.webkitRequestFullscreen;e.call(this.iframe)},e.prototype.exitFullscreen=function(){if(this.isFullscreen(this.iframe)){var e=document.exitFullscreen||document.mozCancelFullScreen||document.webkitExitFullscreen||document.msExitFullscreen;e.call(document)}},e.prototype.isFullscreen=function(e){var t=["fullscreenElement","webkitFullscreenElement","mozFullscreenScreenElement","msFullscreenElement"];return t.some(function(t){return document[t]===e})},e.embedUrlAttribute="powerbi-embed-url",e.accessTokenAttribute="powerbi-access-token",e.typeAttribute="powerbi-type",e.defaultOptions={filterPaneEnabled:!0},e}();t.Embed=r},function(e,t){var n=function(){function e(){}return e.raiseCustomEvent=function(e,t,n){var o;if("function"==typeof CustomEvent?o=new CustomEvent(t,{detail:n,bubbles:!0,cancelable:!0}):(o=document.createEvent("CustomEvent"),o.initCustomEvent(t,!0,!0,n)),e.dispatchEvent(o),!o.defaultPrevented&&o.returnValue){var r="on"+t.replace("-",""),i=e.getAttribute(r);i&&eval.call(e,i)}},e.findIndex=function(e,t){if(!Array.isArray(t))throw new Error("You attempted to call find with second parameter that was not an array. You passed: "+t);var n;return t.some(function(t,o){if(e(t))return n=o,!0}),n},e.find=function(t,n){var o=e.findIndex(t,n);return n[o]},e.remove=function(t,n){var o=e.findIndex(t,n);n.splice(o,1)},e.assign=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];var n=e[0];if(void 0===n||null===n)throw new TypeError("Cannot convert undefined or null to object");for(var o=Object(n),r=1;r<arguments.length;r++){var i=arguments[r];if(void 0!==i&&null!==i)for(var s in i)i.hasOwnProperty(s)&&(o[s]=i[s])}return o},e}();t.Utils=n},function(e,t,n){var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=n(2),i=function(e){function t(){e.apply(this,arguments)}return o(t,e),t.prototype.getEmbedUrl=function(){var t=e.prototype.getEmbedUrl.call(this);return this.options.filterPaneEnabled||(t+="&filterPaneEnabled=false"),t},t.prototype.load=function(t,n){if(void 0===n&&(n=!1),n&&"string"!=typeof t.id)throw new Error("id must be specified when loading reports on existing elements.");var o={action:"loadReport",reportId:t.id,accessToken:null};e.prototype.load.call(this,t,n,o)},t.name="Report",t}(r.Embed);t.Report=i},function(e,t,n){var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=n(2),i=function(e){function t(){e.apply(this,arguments)}return o(t,e),t.prototype.getEmbedUrl=function(){var t=e.prototype.getEmbedUrl.call(this);return t},t.prototype.load=function(t,n){if(void 0===n&&(n=!1),n&&"string"!=typeof t.id)throw new Error("id must be specified when loading reports on existing elements.");var o={action:"loadTile",tileId:t.id,accessToken:null};e.prototype.load.call(this,t,n,o)},t.name="Tile",t}(r.Embed);t.Tile=i}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInBvd2VyYmkuanMiXSwibmFtZXMiOlsibW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImluc3RhbGxlZE1vZHVsZXMiLCJleHBvcnRzIiwibW9kdWxlIiwiaWQiLCJsb2FkZWQiLCJjYWxsIiwibSIsImMiLCJwIiwiY29yZV8xIiwid2luZG93IiwiUG93ZXJiaSIsIlBvd2VyQmkiLCJwb3dlcmJpIiwiZW1iZWRfMSIsInJlcG9ydF8xIiwidGlsZV8xIiwidXRpbF8xIiwiY29uZmlnIiwidGhpcyIsImVtYmVkcyIsImFkZEV2ZW50TGlzdGVuZXIiLCJvblJlY2VpdmVNZXNzYWdlIiwiYmluZCIsIlV0aWxzIiwiYXNzaWduIiwiZGVmYXVsdENvbmZpZyIsImF1dG9FbWJlZE9uQ29udGVudExvYWRlZCIsImVuYWJsZUF1dG9FbWJlZCIsInByb3RvdHlwZSIsImluaXQiLCJjb250YWluZXIiLCJfdGhpcyIsIkhUTUxFbGVtZW50IiwiZG9jdW1lbnQiLCJib2R5IiwiZWxlbWVudHMiLCJBcnJheSIsInNsaWNlIiwicXVlcnlTZWxlY3RvckFsbCIsIkVtYmVkIiwiZW1iZWRVcmxBdHRyaWJ1dGUiLCJmb3JFYWNoIiwiZWxlbWVudCIsImVtYmVkIiwiY29tcG9uZW50IiwicG93ZXJCaUVsZW1lbnQiLCJwb3dlckJpRW1iZWQiLCJlbWJlZEV4aXN0aW5nIiwiZW1iZWROZXciLCJjb21wb25lbnRUeXBlIiwidHlwZSIsImdldEF0dHJpYnV0ZSIsInR5cGVBdHRyaWJ1dGUiLCJFcnJvciIsIkpTT04iLCJzdHJpbmdpZnkiLCJvdXRlckhUTUwiLCJSZXBvcnQiLCJuYW1lIiwidG9Mb3dlckNhc2UiLCJDb21wb25lbnQiLCJmaW5kIiwiY29tcG9uZW50cyIsImdldEdsb2JhbEFjY2Vzc1Rva2VuIiwiYWNjZXNzVG9rZW4iLCJwdXNoIiwieCIsImxvYWQiLCJldmVudCIsImdldCIsInJlc2V0IiwicmVtb3ZlIiwiaWZyYW1lIiwicXVlcnlTZWxlY3RvciIsInNvdXJjZSIsImNvbnRlbnRXaW5kb3ciLCJtZXNzYWdlRGF0YSIsImRhdGEiLCJwYXJzZSIsInJhaXNlQ3VzdG9tRXZlbnQiLCJldmVudE1hcCIsImUiLCJvbkVycm9yIiwiVGlsZSIsInRpbGVDbGlja2VkIiwidGlsZUxvYWRlZCIsInJlcG9ydFBhZ2VMb2FkZWQiLCJhcmdzIiwiX2kiLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJjb25zb2xlIiwibG9nIiwib3B0aW9ucyIsImRlZmF1bHRPcHRpb25zIiwiZ2V0QWNjZXNzVG9rZW4iLCJlbWJlZFVybCIsImdldEVtYmVkVXJsIiwiaWZyYW1lSHRtbCIsImlubmVySFRNTCIsImNoaWxkTm9kZXMiLCJyZXF1aXJlSWQiLCJtZXNzYWdlIiwiYmFzZU1lc3NhZ2UiLCJhY3Rpb24iLCJwb3N0TWVzc2FnZSIsImFjY2Vzc1Rva2VuQXR0cmlidXRlIiwiZnVsbHNjcmVlbiIsInJlcXVlc3RGdWxsU2NyZWVuIiwicmVxdWVzdEZ1bGxzY3JlZW4iLCJtc1JlcXVlc3RGdWxsc2NyZWVuIiwibW96UmVxdWVzdEZ1bGxTY3JlZW4iLCJ3ZWJraXRSZXF1ZXN0RnVsbHNjcmVlbiIsImV4aXRGdWxsc2NyZWVuIiwiaXNGdWxsc2NyZWVuIiwibW96Q2FuY2VsRnVsbFNjcmVlbiIsIndlYmtpdEV4aXRGdWxsc2NyZWVuIiwibXNFeGl0RnVsbHNjcmVlbiIsInNvbWUiLCJvcHRpb24iLCJmaWx0ZXJQYW5lRW5hYmxlZCIsImV2ZW50TmFtZSIsImV2ZW50RGF0YSIsImN1c3RvbUV2ZW50IiwiQ3VzdG9tRXZlbnQiLCJkZXRhaWwiLCJidWJibGVzIiwiY2FuY2VsYWJsZSIsImNyZWF0ZUV2ZW50IiwiaW5pdEN1c3RvbUV2ZW50IiwiZGlzcGF0Y2hFdmVudCIsImRlZmF1bHRQcmV2ZW50ZWQiLCJyZXR1cm5WYWx1ZSIsImlubGluZUV2ZW50QXR0ciIsInJlcGxhY2UiLCJpbmxpbmVTY3JpcHQiLCJldmFsIiwiZmluZEluZGV4IiwicHJlZGljYXRlIiwieHMiLCJpc0FycmF5IiwiaW5kZXgiLCJpIiwic3BsaWNlIiwidGFyZ2V0IiwidW5kZWZpbmVkIiwiVHlwZUVycm9yIiwib3V0cHV0IiwiT2JqZWN0IiwibmV4dEtleSIsImhhc093blByb3BlcnR5IiwiX19leHRlbmRzIiwiZCIsImIiLCJfXyIsImNvbnN0cnVjdG9yIiwiY3JlYXRlIiwiX3N1cGVyIiwiYXBwbHkiLCJyZXBvcnRJZCIsInRpbGVJZCJdLCJtYXBwaW5ncyI6IkNBQVMsU0FBVUEsR0FLVCxRQUFTQyxHQUFvQkMsR0FHNUIsR0FBR0MsRUFBaUJELEdBQ25CLE1BQU9DLEdBQWlCRCxHQUFVRSxPQUduQyxJQUFJQyxHQUFTRixFQUFpQkQsSUFDN0JFLFdBQ0FFLEdBQUlKLEVBQ0pLLFFBQVEsRUFVVCxPQU5BUCxHQUFRRSxHQUFVTSxLQUFLSCxFQUFPRCxRQUFTQyxFQUFRQSxFQUFPRCxRQUFTSCxHQUcvREksRUFBT0UsUUFBUyxFQUdURixFQUFPRCxRQXZCZixHQUFJRCxLQXFDSixPQVRBRixHQUFvQlEsRUFBSVQsRUFHeEJDLEVBQW9CUyxFQUFJUCxFQUd4QkYsRUFBb0JVLEVBQUksR0FHakJWLEVBQW9CLEtBSy9CLFNBQVNJLEVBQVFELEVBQVNILEdBRS9CLEdBQUlXLEdBQVNYLEVBQW9CLEVBTWpDWSxRQUFPQyxRQUFVRixFQUFPRyxRQUN4QkYsT0FBT0csUUFBVSxHQUFJSixHQUFPRyxTQUt2QixTQUFTVixFQUFRRCxFQUFTSCxHQUUvQixHQUFJZ0IsR0FBVWhCLEVBQW9CLEdBQzlCaUIsRUFBV2pCLEVBQW9CLEdBQy9Ca0IsRUFBU2xCLEVBQW9CLEdBQzdCbUIsRUFBU25CLEVBQW9CLEdBQzdCYyxFQUFXLFdBQ1gsUUFBU0EsR0FBUU0sR0FDRSxTQUFYQSxJQUFxQkEsTUFDekJDLEtBQUtDLFVBQ0xWLE9BQU9XLGlCQUFpQixVQUFXRixLQUFLRyxpQkFBaUJDLEtBQUtKLE9BQU8sR0FFckVBLEtBQUtELE9BQVNELEVBQU9PLE1BQU1DLFVBQVdiLEVBQVFjLGNBQWVSLEdBQ3pEQyxLQUFLRCxPQUFP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LEtBRS9FN0ksRUFBVWhCLEVBQW9CLEdBQzlCc0YsRUFBUSxTQUFVMEUsR0FFbEIsUUFBUzFFLEtBQ0wwRSxFQUFPQyxNQUFNNUksS0FBTXVFLFdBbUJ2QixNQXJCQThELEdBQVVwRSxFQUFNMEUsR0FJaEIxRSxFQUFLdkQsVUFBVXFFLFlBQWMsV0FDekIsR0FBSUQsR0FBVzZELEVBQU9qSSxVQUFVcUUsWUFBWTdGLEtBQUtjLEtBQ2pELE9BQU84RSxJQUVYYixFQUFLdkQsVUFBVXVDLEtBQU8sU0FBVTBCLEVBQVNRLEdBRXJDLEdBRGtCLFNBQWRBLElBQXdCQSxHQUFZLEdBQ3BDQSxHQUFtQyxnQkFBZlIsR0FBUTNGLEdBQzVCLEtBQU0sSUFBSW1ELE9BQU0sa0VBRXBCLElBQUlpRCxJQUNBRSxPQUFRLFdBQ1J3RCxPQUFRbkUsRUFBUTNGLEdBQ2hCOEQsWUFBYSxLQUVqQjZGLEdBQU9qSSxVQUFVdUMsS0FBSy9ELEtBQUtjLEtBQU0yRSxFQUFTUSxFQUFXQyxJQUV6RG5CLEVBQUt6QixLQUFPLE9BQ0x5QixHQUNUdEUsRUFBUTBCLE1BQ1Z2QyxHQUFRbUYsS0FBT0EiLCJmaWxlIjoicG93ZXJiaS5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKioqKiovIChmdW5jdGlvbihtb2R1bGVzKSB7IC8vIHdlYnBhY2tCb290c3RyYXBcbi8qKioqKiovIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuLyoqKioqKi8gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbi8qKioqKiovIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbi8qKioqKiovIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSlcbi8qKioqKiovIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuLyoqKioqKi8gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbi8qKioqKiovIFx0XHRcdGV4cG9ydHM6IHt9LFxuLyoqKioqKi8gXHRcdFx0aWQ6IG1vZHVsZUlkLFxuLyoqKioqKi8gXHRcdFx0bG9hZGVkOiBmYWxzZVxuLyoqKioqKi8gXHRcdH07XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuLyoqKioqKi8gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4vKioqKioqLyBcdFx0bW9kdWxlLmxvYWRlZCA9IHRydWU7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4vKioqKioqLyBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuLyoqKioqKi8gXHR9XG4vKioqKioqL1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4vKioqKioqLyBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKDApO1xuLyoqKioqKi8gfSlcbi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4vKioqKioqLyAoW1xuLyogMCAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0dmFyIGNvcmVfMSA9IF9fd2VicGFja19yZXF1aXJlX18oMSk7XG5cdC8qKlxuXHQgKiBNYWtlIFBvd2VyQmkgYXZhaWxhYmxlIG9uIGdsb2JhbCBvYmplY3QgZm9yIHVzZSBpbiBhcHBzIHdpdGhvdXQgbW9kdWxlIGxvYWRpbmcgc3VwcG9ydC5cblx0ICogU2F2ZSBjbGFzcyB0byBhbGxvdyBjcmVhdGluZyBhbiBpbnN0YW5jZSBvZiB0aGUgc2VydmljZS5cblx0ICogQ3JlYXRlIGluc3RhbmNlIG9mIGNsYXNzIHdpdGggZGVmYXVsdCBjb25maWcgZm9yIG5vcm1hbCB1c2FnZS5cblx0ICovXG5cdHdpbmRvdy5Qb3dlcmJpID0gY29yZV8xLlBvd2VyQmk7XG5cdHdpbmRvdy5wb3dlcmJpID0gbmV3IGNvcmVfMS5Qb3dlckJpKCk7XG5cblxuLyoqKi8gfSxcbi8qIDEgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdHZhciBlbWJlZF8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKTtcblx0dmFyIHJlcG9ydF8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0KTtcblx0dmFyIHRpbGVfMSA9IF9fd2VicGFja19yZXF1aXJlX18oNSk7XG5cdHZhciB1dGlsXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpO1xuXHR2YXIgUG93ZXJCaSA9IChmdW5jdGlvbiAoKSB7XG5cdCAgICBmdW5jdGlvbiBQb3dlckJpKGNvbmZpZykge1xuXHQgICAgICAgIGlmIChjb25maWcgPT09IHZvaWQgMCkgeyBjb25maWcgPSB7fTsgfVxuXHQgICAgICAgIHRoaXMuZW1iZWRzID0gW107XG5cdCAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCB0aGlzLm9uUmVjZWl2ZU1lc3NhZ2UuYmluZCh0aGlzKSwgZmFsc2UpO1xuXHQgICAgICAgIC8vIFRPRE86IENoYW5nZSB3aGVuIE9iamVjdC5hc3NpZ24gaXMgYXZhaWxhYmxlLlxuXHQgICAgICAgIHRoaXMuY29uZmlnID0gdXRpbF8xLlV0aWxzLmFzc2lnbih7fSwgUG93ZXJCaS5kZWZhdWx0Q29uZmlnLCBjb25maWcpO1xuXHQgICAgICAgIGlmICh0aGlzLmNvbmZpZy5hdXRvRW1iZWRPbkNvbnRlbnRMb2FkZWQpIHtcblx0ICAgICAgICAgICAgdGhpcy5lbmFibGVBdXRvRW1iZWQoKTtcblx0ICAgICAgICB9XG5cdCAgICB9XG5cdCAgICAvKipcblx0ICAgICAqIEhhbmRsZXIgZm9yIERPTUNvbnRlbnRMb2FkZWQgd2hpY2ggc2VhcmNoZXMgRE9NIGZvciBlbGVtZW50cyBoYXZpbmcgJ3Bvd2VyYmktZW1iZWQtdXJsJyBhdHRyaWJ1dGVcblx0ICAgICAqIGFuZCBhdXRvbWF0aWNhbGx5IGF0dGVtcHRzIHRvIGVtYmVkIGEgcG93ZXJiaSBjb21wb25lbnQgYmFzZWQgb24gaW5mb3JtYXRpb24gZnJvbSB0aGUgYXR0cmlidXRlcy5cblx0ICAgICAqIE9ubHkgcnVucyBpZiBgY29uZmlnLmF1dG9FbWJlZE9uQ29udGVudExvYWRlZGAgaXMgdHJ1ZSB3aGVuIHRoZSBzZXJ2aWNlIGlzIGNyZWF0ZWQuXG5cdCAgICAgKi9cblx0ICAgIFBvd2VyQmkucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbiAoY29udGFpbmVyKSB7XG5cdCAgICAgICAgdmFyIF90aGlzID0gdGhpcztcblx0ICAgICAgICBjb250YWluZXIgPSAoY29udGFpbmVyICYmIGNvbnRhaW5lciBpbnN0YW5jZW9mIEhUTUxFbGVtZW50KSA/IGNvbnRhaW5lciA6IGRvY3VtZW50LmJvZHk7XG5cdCAgICAgICAgdmFyIGVsZW1lbnRzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3JBbGwoXCJbXCIgKyBlbWJlZF8xLkVtYmVkLmVtYmVkVXJsQXR0cmlidXRlICsgXCJdXCIpKTtcblx0ICAgICAgICBlbGVtZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChlbGVtZW50KSB7IHJldHVybiBfdGhpcy5lbWJlZChlbGVtZW50KTsgfSk7XG5cdCAgICB9O1xuXHQgICAgLyoqXG5cdCAgICAgKiBHaXZlbiBhbiBodG1sIGVsZW1lbnQgZW1iZWQgY29tcG9uZW50IGJhc2VkIG9uIGNvbmZpZ3VyYXRpb24uXG5cdCAgICAgKiBJZiBjb21wb25lbnQgaGFzIGFscmVhZHkgYmVlbiBjcmVhdGVkIGFuZCBhdHRhY2hlZCB0byBlbGVtZW50IHJlLXVzZSBjb21wb25lbnQgaW5zdGFuY2UgYW5kIGV4aXN0aW5nIGlmcmFtZSxcblx0ICAgICAqIG90aGVyd2lzZSBjcmVhdGUgYSBuZXcgY29tcG9uZW50IGluc3RhbmNlXG5cdCAgICAgKi9cblx0ICAgIFBvd2VyQmkucHJvdG90eXBlLmVtYmVkID0gZnVuY3Rpb24gKGVsZW1lbnQsIGNvbmZpZykge1xuXHQgICAgICAgIGlmIChjb25maWcgPT09IHZvaWQgMCkgeyBjb25maWcgPSB7fTsgfVxuXHQgICAgICAgIHZhciBjb21wb25lbnQ7XG5cdCAgICAgICAgdmFyIHBvd2VyQmlFbGVtZW50ID0gZWxlbWVudDtcblx0ICAgICAgICBpZiAocG93ZXJCaUVsZW1lbnQucG93ZXJCaUVtYmVkKSB7XG5cdCAgICAgICAgICAgIGNvbXBvbmVudCA9IHRoaXMuZW1iZWRFeGlzdGluZyhwb3dlckJpRWxlbWVudCwgY29uZmlnKTtcblx0ICAgICAgICB9XG5cdCAgICAgICAgZWxzZSB7XG5cdCAgICAgICAgICAgIGNvbXBvbmVudCA9IHRoaXMuZW1iZWROZXcocG93ZXJCaUVsZW1lbnQsIGNvbmZpZyk7XG5cdCAgICAgICAgfVxuXHQgICAgICAgIHJldHVybiBjb21wb25lbnQ7XG5cdCAgICB9O1xuXHQgICAgLyoqXG5cdCAgICAgKiBHaXZlbiBhbiBodG1sIGVsZW1lbnQgZW1iZWQgY29tcG9uZW50IGJhc2UgY29uZmlndXJhdGlvbi5cblx0ICAgICAqIFNhdmUgY29tcG9uZW50IGluc3RhbmNlIG9uIGVsZW1lbnQgZm9yIGxhdGVyIGxvb2t1cC5cblx0ICAgICAqL1xuXHQgICAgUG93ZXJCaS5wcm90b3R5cGUuZW1iZWROZXcgPSBmdW5jdGlvbiAoZWxlbWVudCwgY29uZmlnKSB7XG5cdCAgICAgICAgdmFyIF90aGlzID0gdGhpcztcblx0ICAgICAgICB2YXIgY29tcG9uZW50VHlwZSA9IGNvbmZpZy50eXBlIHx8IGVsZW1lbnQuZ2V0QXR0cmlidXRlKGVtYmVkXzEuRW1iZWQudHlwZUF0dHJpYnV0ZSk7XG5cdCAgICAgICAgaWYgKCFjb21wb25lbnRUeXBlKSB7XG5cdCAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkF0dGVtcHRlZCB0byBlbWJlZCB1c2luZyBjb25maWcgXCIgKyBKU09OLnN0cmluZ2lmeShjb25maWcpICsgXCIgb24gZWxlbWVudCBcIiArIGVsZW1lbnQub3V0ZXJIVE1MICsgXCIsIGJ1dCBjb3VsZCBub3QgZGV0ZXJtaW5lIHdoYXQgdHlwZSBvZiBjb21wb25lbnQgdG8gZW1iZWQuIFlvdSBtdXN0IHNwZWNpZnkgYSB0eXBlIGluIHRoZSBjb25maWd1cmF0aW9uIG9yIGFzIGFuIGF0dHJpYnV0ZSBzdWNoIGFzICdcIiArIGVtYmVkXzEuRW1iZWQudHlwZUF0dHJpYnV0ZSArIFwiPVxcXCJcIiArIHJlcG9ydF8xLlJlcG9ydC5uYW1lLnRvTG93ZXJDYXNlKCkgKyBcIlxcXCInLlwiKTtcblx0ICAgICAgICB9XG5cdCAgICAgICAgLy8gU2F2ZSB0eXBlIG9uIGNvbmZpZ3VyYXRpb24gc28gaXQgY2FuIGJlIHJlZmVyZW5jZWQgbGF0ZXIgYXQga25vd24gbG9jYXRpb25cblx0ICAgICAgICBjb25maWcudHlwZSA9IGNvbXBvbmVudFR5cGU7XG5cdCAgICAgICAgdmFyIENvbXBvbmVudCA9IHV0aWxfMS5VdGlscy5maW5kKGZ1bmN0aW9uIChjb21wb25lbnQpIHsgcmV0dXJuIGNvbXBvbmVudFR5cGUgPT09IGNvbXBvbmVudC5uYW1lLnRvTG93ZXJDYXNlKCk7IH0sIFBvd2VyQmkuY29tcG9uZW50cyk7XG5cdCAgICAgICAgaWYgKCFDb21wb25lbnQpIHtcblx0ICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQXR0ZW1wdGVkIHRvIGVtYmVkIGNvbXBvbmVudCBvZiB0eXBlOiBcIiArIGNvbXBvbmVudFR5cGUgKyBcIiBidXQgZGlkIG5vdCBmaW5kIGFueSBtYXRjaGluZyBjb21wb25lbnQuICBQbGVhc2UgdmVyaWZ5IHRoZSB0eXBlIHlvdSBzcGVjaWZpZWQgaXMgaW50ZW5kZWQuXCIpO1xuXHQgICAgICAgIH1cblx0ICAgICAgICAvLyBUT0RPOiBDb25zaWRlciByZW1vdmluZyBpbiBmYXZvciBvZiBwYXNzaW5nIHJlZmVyZW5jZSB0byBgdGhpc2AgaW4gY29uc3RydWN0b3Jcblx0ICAgICAgICAvLyBUaGUgZ2V0R2xvYmFsQWNjZXNzVG9rZW4gZnVuY3Rpb24gaXMgb25seSBoZXJlIHNvIHRoYXQgdGhlIGNvbXBvbmVudHMgKFRpbGUgfCBSZXBvcnQpIGNhbiBnZXQgdGhlIGdsb2JhbCBhY2Nlc3MgdG9rZW4gd2l0aG91dCBuZWVkaW5nIHJlZmVyZW5jZVxuXHQgICAgICAgIC8vIHRvIHRoZSBzZXJ2aWNlIHRoYXQgdGhleSBhcmUgcmVnaXN0ZXJlZCB3aXRoaW4gYmVjYXVlcyBpdCBjcmVhdGVzIGNpcmN1bGFyIGRlcGVuZGVuY2llc1xuXHQgICAgICAgIGNvbmZpZy5nZXRHbG9iYWxBY2Nlc3NUb2tlbiA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLmFjY2Vzc1Rva2VuOyB9O1xuXHQgICAgICAgIHZhciBjb21wb25lbnQgPSBuZXcgQ29tcG9uZW50KGVsZW1lbnQsIGNvbmZpZyk7XG5cdCAgICAgICAgZWxlbWVudC5wb3dlckJpRW1iZWQgPSBjb21wb25lbnQ7XG5cdCAgICAgICAgdGhpcy5lbWJlZHMucHVzaChjb21wb25lbnQpO1xuXHQgICAgICAgIHJldHVybiBjb21wb25lbnQ7XG5cdCAgICB9O1xuXHQgICAgUG93ZXJCaS5wcm90b3R5cGUuZW1iZWRFeGlzdGluZyA9IGZ1bmN0aW9uIChlbGVtZW50LCBjb25maWcpIHtcblx0ICAgICAgICB2YXIgY29tcG9uZW50ID0gdXRpbF8xLlV0aWxzLmZpbmQoZnVuY3Rpb24gKHgpIHsgcmV0dXJuIHguZWxlbWVudCA9PT0gZWxlbWVudDsgfSwgdGhpcy5lbWJlZHMpO1xuXHQgICAgICAgIGlmICghY29tcG9uZW50KSB7XG5cdCAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkF0dGVtcHRlZCB0byBlbWJlZCB1c2luZyBjb25maWcgXCIgKyBKU09OLnN0cmluZ2lmeShjb25maWcpICsgXCIgb24gZWxlbWVudCBcIiArIGVsZW1lbnQub3V0ZXJIVE1MICsgXCIgd2hpY2ggYWxyZWFkeSBoYXMgZW1iZWRkZWQgY29tb3BuZW50IGFzc29jaWF0ZWQsIGJ1dCBjb3VsZCBub3QgZmluZCB0aGUgZXhpc3RpbmcgY29tb3BuZW50IGluIHRoZSBsaXN0IG9mIGFjdGl2ZSBjb21wb25lbnRzLiBUaGlzIGNvdWxkIGluZGljYXRlIHRoZSBlbWJlZHMgbGlzdCBpcyBvdXQgb2Ygc3luYyB3aXRoIHRoZSBET00sIG9yIHRoZSBjb21wb25lbnQgaXMgcmVmZXJlbmNpbmcgdGhlIGluY29ycmVjdCBIVE1MIGVsZW1lbnQuXCIpO1xuXHQgICAgICAgIH1cblx0ICAgICAgICBjb21wb25lbnQubG9hZChjb25maWcsIHRydWUpO1xuXHQgICAgICAgIHJldHVybiBjb21wb25lbnQ7XG5cdCAgICB9O1xuXHQgICAgLyoqXG5cdCAgICAgKiBBZGRzIGV2ZW50IGhhbmRsZXIgZm9yIERPTUNvbnRlbnRMb2FkZWQgd2hpY2ggZmluZHMgYWxsIGVsZW1lbnRzIGluIERPTSB3aXRoIGF0dHJpYnV0ZSBwb3dlcmJpLWVtYmVkLXVybFxuXHQgICAgICogdGhlbiBhdHRlbXB0cyB0byBpbml0aWF0ZSB0aGUgZW1iZWQgcHJvY2VzcyBiYXNlZCBvbiBkYXRhIGZyb20gb3RoZXIgcG93ZXJiaS0qIGF0dHJpYnV0ZXMuXG5cdCAgICAgKiAoVGhpcyBpcyB1c3VhbGx5IG9ubHkgdXNlZnVsIGZvciBhcHBsaWNhdGlvbnMgcmVuZGVyZWQgb24gYnkgdGhlIHNlcnZlciBzaW5jZSBhbGwgdGhlIGRhdGEgbmVlZGVkIHdpbGwgYmUgYXZhaWxhYmxlIGJ5IHRoZSB0aW1lIHRoZSBoYW5kbGVyIGlzIGNhbGxlZC4pXG5cdCAgICAgKi9cblx0ICAgIFBvd2VyQmkucHJvdG90eXBlLmVuYWJsZUF1dG9FbWJlZCA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuXHQgICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgZnVuY3Rpb24gKGV2ZW50KSB7IHJldHVybiBfdGhpcy5pbml0KGRvY3VtZW50LmJvZHkpOyB9LCBmYWxzZSk7XG5cdCAgICB9O1xuXHQgICAgLyoqXG5cdCAgICAgKiBSZXR1cm5zIGluc3RhbmNlIG9mIGNvbXBvbmVudCBhc3NvY2lhdGVkIHdpdGggZWxlbWVudC5cblx0ICAgICAqL1xuXHQgICAgUG93ZXJCaS5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24gKGVsZW1lbnQpIHtcblx0ICAgICAgICB2YXIgcG93ZXJCaUVsZW1lbnQgPSBlbGVtZW50O1xuXHQgICAgICAgIGlmICghcG93ZXJCaUVsZW1lbnQucG93ZXJCaUVtYmVkKSB7XG5cdCAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIllvdSBhdHRlbXB0ZWQgdG8gZ2V0IGFuIGluc3RhbmNlIG9mIHBvd2VyYmkgY29tcG9uZW50IGFzc29jaWF0ZWQgd2l0aCBlbGVtZW50OiBcIiArIGVsZW1lbnQub3V0ZXJIVE1MICsgXCIgYnV0IHRoZXJlIHdhcyBubyBhc3NvY2lhdGVkIGluc3RhbmNlLlwiKTtcblx0ICAgICAgICB9XG5cdCAgICAgICAgcmV0dXJuIHBvd2VyQmlFbGVtZW50LnBvd2VyQmlFbWJlZDtcblx0ICAgIH07XG5cdCAgICAvKipcblx0ICAgICAqIEdpdmVuIGFuIGh0bWwgZWxlbWVudCB3aGljaCBoYXMgY29tcG9uZW50IGVtYmVkZGVkIHdpdGhpbiBpdCwgcmVtb3ZlIHRoZSBjb21wb25lbnQgZnJvbSBsaXN0IG9mIGVtYmVkcywgcmVtb3ZlIGFzc29jaWF0aW9uIHdpdGggY29tcG9uZW50LCBhbmQgcmVtb3ZlIHRoZSBpZnJhbWUuXG5cdCAgICAgKi9cblx0ICAgIFBvd2VyQmkucHJvdG90eXBlLnJlc2V0ID0gZnVuY3Rpb24gKGVsZW1lbnQpIHtcblx0ICAgICAgICB2YXIgcG93ZXJCaUVsZW1lbnQgPSBlbGVtZW50O1xuXHQgICAgICAgIGlmICghcG93ZXJCaUVsZW1lbnQucG93ZXJCaUVtYmVkKSB7XG5cdCAgICAgICAgICAgIHJldHVybjtcblx0ICAgICAgICB9XG5cdCAgICAgICAgLyoqIFJlbW92ZSBjb21wb25lbnQgZnJvbSBpbnRlcm5hbCBsaXN0ICovXG5cdCAgICAgICAgdXRpbF8xLlV0aWxzLnJlbW92ZShmdW5jdGlvbiAoeCkgeyByZXR1cm4geCA9PT0gcG93ZXJCaUVsZW1lbnQucG93ZXJCaUVtYmVkOyB9LCB0aGlzLmVtYmVkcyk7XG5cdCAgICAgICAgLyoqIERlbGV0ZSBwcm9wZXJ0eSBmcm9tIGh0bWwgZWxlbWVudCAqL1xuXHQgICAgICAgIGRlbGV0ZSBwb3dlckJpRWxlbWVudC5wb3dlckJpRW1iZWQ7XG5cdCAgICAgICAgLyoqIFJlbW92ZSBpZnJhbWUgZnJvbSBlbGVtZW50ICovXG5cdCAgICAgICAgdmFyIGlmcmFtZSA9IGVsZW1lbnQucXVlcnlTZWxlY3RvcignaWZyYW1lJyk7XG5cdCAgICAgICAgaWYgKGlmcmFtZSkge1xuXHQgICAgICAgICAgICBpZnJhbWUucmVtb3ZlKCk7XG5cdCAgICAgICAgfVxuXHQgICAgfTtcblx0ICAgIC8qKlxuXHQgICAgICogSGFuZGxlciBmb3Igd2luZG93IG1lc3NhZ2UgZXZlbnQuXG5cdCAgICAgKiBQYXJzZXMgZXZlbnQgZGF0YSBhcyBqc29uIGFuZCBpZiBpdCBjYW1lIGZyb20gYW4gaWZyYW1lIHRoYXQgbWF0Y2hlcyBvbmUgZnJvbSBhbiBleGlzdGluZyBlbWJlZGVkIGNvbXBvbmVudCByZS1kaXNwYXRjaGVzIHRoZSBldmVudCBvbiB0aGUgaWZyYW1lJ3MgcGFyZW50IGVsZW1lbnRcblx0ICAgICAqIHRvIHNpbXVsYXRlIHRoZSBldmVudCBidWJibGluZyB0aHJvdWdoIHRoZSB0d28gc2VwYXJhdGUgd2luZG93cyAvIERPTXMuXG5cdCAgICAgKlxuXHQgICAgICogSWYgYW4gZXJyb3Igb2NjdXJzIHdoZW4gcGFyc2luZyBldmVudC5kYXRhIGNhbGwgZXJyb3IgaGFuZGxlciBwcm92aWRlZCBkdXJpbmcgY29uZmlndXJhdGlvbi5cblx0ICAgICAqL1xuXHQgICAgUG93ZXJCaS5wcm90b3R5cGUub25SZWNlaXZlTWVzc2FnZSA9IGZ1bmN0aW9uIChldmVudCkge1xuXHQgICAgICAgIGlmICghZXZlbnQpIHtcblx0ICAgICAgICAgICAgcmV0dXJuO1xuXHQgICAgICAgIH1cblx0ICAgICAgICB0cnkge1xuXHQgICAgICAgICAgICAvLyBPbmx5IHJhaXNlIHRoZSBldmVudCBvbiB0aGUgZW1iZWQgdGhhdCBtYXRjaGVzIHRoZSBwb3N0IG1lc3NhZ2Ugb3JpZ2luXG5cdCAgICAgICAgICAgIHZhciBlbWJlZCA9IHV0aWxfMS5VdGlscy5maW5kKGZ1bmN0aW9uIChlbWJlZCkgeyByZXR1cm4gZXZlbnQuc291cmNlID09PSBlbWJlZC5pZnJhbWUuY29udGVudFdpbmRvdzsgfSwgdGhpcy5lbWJlZHMpO1xuXHQgICAgICAgICAgICBpZiAoZW1iZWQpIHtcblx0ICAgICAgICAgICAgICAgIHZhciBtZXNzYWdlRGF0YSA9IHR5cGVvZiBldmVudC5kYXRhID09PSAnc3RyaW5nJyA/IEpTT04ucGFyc2UoZXZlbnQuZGF0YSkgOiBldmVudC5kYXRhO1xuXHQgICAgICAgICAgICAgICAgdXRpbF8xLlV0aWxzLnJhaXNlQ3VzdG9tRXZlbnQoZW1iZWQuZWxlbWVudCwgUG93ZXJCaS5ldmVudE1hcFttZXNzYWdlRGF0YS5ldmVudF0sIG1lc3NhZ2VEYXRhKTtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgIH1cblx0ICAgICAgICBjYXRjaCAoZSkge1xuXHQgICAgICAgICAgICBpZiAodHlwZW9mIHRoaXMuY29uZmlnLm9uRXJyb3IgPT09ICdmdW5jdGlvbicpIHtcblx0ICAgICAgICAgICAgICAgIHRoaXMuY29uZmlnLm9uRXJyb3IuY2FsbCh3aW5kb3csIGUpO1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIGVsc2Uge1xuXHQgICAgICAgICAgICAgICAgdGhyb3cgZTtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgIH1cblx0ICAgIH07XG5cdCAgICAvKipcblx0ICAgICAqIExpc3Qgb2YgY29tcG9uZW50cyB0aGlzIHNlcnZpY2UgY2FuIGVtYmVkLlxuXHQgICAgICovXG5cdCAgICBQb3dlckJpLmNvbXBvbmVudHMgPSBbXG5cdCAgICAgICAgdGlsZV8xLlRpbGUsXG5cdCAgICAgICAgcmVwb3J0XzEuUmVwb3J0XG5cdCAgICBdO1xuXHQgICAgLyoqXG5cdCAgICAgKiBNYXBwaW5nIG9mIGV2ZW50IG5hbWVzIGZyb20gaWZyYW1lIHBvc3RNZXNzYWdlIHRvIHRoZWlyIG5hbWUgcGVyY2lldmVkIGJ5IHBhcmVudCBET00uXG5cdCAgICAgKiBFeGFtcGxlOiBVc2VyIGNsaWNrcyBvbiBlbWJlZGVkIHJlcG9ydCB3aGljaCBpcyBpbnNpZGUgaWZyYW1lLiBUaGUgaWZyYW1lIGNvZGUgcmVzZW5kc1xuXHQgICAgICogZXZlbnQgYXMgcG9zdE1lc3NhZ2Ugd2l0aCB7IGV2ZW50OiAncmVwb3J0Q2xpY2tlZCcsIC4uLiB9IGFuZCB0aGlzIG5hbWUgaXMgY29udmVydGVkIHRvIGh5cGhlbmF0ZWRcblx0ICAgICAqIG5hbWUgYW5kIGRpc3BhdGNoZWQgZnJvbSB0aGUgcGFyZW50IGVsZW1lbnQgb2YgdGhlIGlmcmFtZSB0byBzaW11bGF0ZSB0aGUgZXZlbnQgYnViYmxpbmcgdGhyb3VnaCB0d29cblx0ICAgICAqIGRpZmZlcmVudCB3aW5kb3dzIC8gRE9Nc1xuXHQgICAgICovXG5cdCAgICBQb3dlckJpLmV2ZW50TWFwID0ge1xuXHQgICAgICAgICd0aWxlQ2xpY2tlZCc6ICd0aWxlLWNsaWNrJyxcblx0ICAgICAgICAndGlsZUxvYWRlZCc6ICd0aWxlLWxvYWQnLFxuXHQgICAgICAgICdyZXBvcnRQYWdlTG9hZGVkJzogJ3JlcG9ydC1sb2FkJ1xuXHQgICAgfTtcblx0ICAgIC8qKlxuXHQgICAgICogRGVmYXVsdCBjb25maWd1cmF0aW9uIGZvciBzZXJ2aWNlLlxuXHQgICAgICovXG5cdCAgICBQb3dlckJpLmRlZmF1bHRDb25maWcgPSB7XG5cdCAgICAgICAgYXV0b0VtYmVkT25Db250ZW50TG9hZGVkOiBmYWxzZSxcblx0ICAgICAgICBvbkVycm9yOiBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgICAgIHZhciBhcmdzID0gW107XG5cdCAgICAgICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG5cdCAgICAgICAgICAgICAgICBhcmdzW19pIC0gMF0gPSBhcmd1bWVudHNbX2ldO1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIHJldHVybiBjb25zb2xlLmxvZyhhcmdzWzBdLCBhcmdzLnNsaWNlKDEpKTtcblx0ICAgICAgICB9XG5cdCAgICB9O1xuXHQgICAgcmV0dXJuIFBvd2VyQmk7XG5cdH0oKSk7XG5cdGV4cG9ydHMuUG93ZXJCaSA9IFBvd2VyQmk7XG5cdC8vIGV4cG9ydCBkZWZhdWx0IFBvd2VyQmk7IFxuXG5cbi8qKiovIH0sXG4vKiAyICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHR2YXIgdXRpbF8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTtcblx0dmFyIEVtYmVkID0gKGZ1bmN0aW9uICgpIHtcblx0ICAgIGZ1bmN0aW9uIEVtYmVkKGVsZW1lbnQsIG9wdGlvbnMpIHtcblx0ICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuXHQgICAgICAgIHRoaXMuZWxlbWVudCA9IGVsZW1lbnQ7XG5cdCAgICAgICAgLy8gVE9ETzogQ2hhbmdlIHdoZW4gT2JqZWN0LmFzc2lnbiBpcyBhdmFpbGFibGUuXG5cdCAgICAgICAgdGhpcy5vcHRpb25zID0gdXRpbF8xLlV0aWxzLmFzc2lnbih7fSwgRW1iZWQuZGVmYXVsdE9wdGlvbnMsIG9wdGlvbnMpO1xuXHQgICAgICAgIHRoaXMub3B0aW9ucy5hY2Nlc3NUb2tlbiA9IHRoaXMuZ2V0QWNjZXNzVG9rZW4oKTtcblx0ICAgICAgICB0aGlzLm9wdGlvbnMuZW1iZWRVcmwgPSB0aGlzLmdldEVtYmVkVXJsKCk7XG5cdCAgICAgICAgdmFyIGlmcmFtZUh0bWwgPSBcIjxpZnJhbWUgc3R5bGU9XFxcIndpZHRoOjEwMCU7aGVpZ2h0OjEwMCU7XFxcIiBzcmM9XFxcIlwiICsgdGhpcy5vcHRpb25zLmVtYmVkVXJsICsgXCJcXFwiIHNjcm9sbGluZz1cXFwibm9cXFwiIGFsbG93ZnVsbHNjcmVlbj1cXFwidHJ1ZVxcXCI+PC9pZnJhbWU+XCI7XG5cdCAgICAgICAgdGhpcy5lbGVtZW50LmlubmVySFRNTCA9IGlmcmFtZUh0bWw7XG5cdCAgICAgICAgdGhpcy5pZnJhbWUgPSB0aGlzLmVsZW1lbnQuY2hpbGROb2Rlc1swXTtcblx0ICAgICAgICB0aGlzLmlmcmFtZS5hZGRFdmVudExpc3RlbmVyKCdsb2FkJywgZnVuY3Rpb24gKCkgeyByZXR1cm4gX3RoaXMubG9hZChfdGhpcy5vcHRpb25zLCBmYWxzZSk7IH0sIGZhbHNlKTtcblx0ICAgIH1cblx0ICAgIC8qKlxuXHQgICAgICogSGFuZGxlciBmb3Igd2hlbiB0aGUgaWZyYW1lIGhhcyBmaW5pc2hlZCBsb2FkaW5nIHRoZSBwb3dlcmJpIHBsYWNlaG9sZGVyIHBhZ2UuXG5cdCAgICAgKiBUaGlzIGlzIHVzZWQgdG8gaW5qZWN0IGNvbmZpZ3VyYXRpb24gb3B0aW9ucyBzdWNoIGFzIGFjY2VzcyB0b2tlbiwgbG9hZEFjdGlvbiwgZXRjXG5cdCAgICAgKiB3aGljaCBhbGxvdyBpZnJhbWUgdG8gbG9hZCB0aGUgYWN0dWFsIHJlcG9ydCB3aXRoIGF1dGhlbnRpY2F0aW9uLlxuXHQgICAgICovXG5cdCAgICBFbWJlZC5wcm90b3R5cGUubG9hZCA9IGZ1bmN0aW9uIChvcHRpb25zLCByZXF1aXJlSWQsIG1lc3NhZ2UpIHtcblx0ICAgICAgICBpZiAocmVxdWlyZUlkID09PSB2b2lkIDApIHsgcmVxdWlyZUlkID0gZmFsc2U7IH1cblx0ICAgICAgICBpZiAobWVzc2FnZSA9PT0gdm9pZCAwKSB7IG1lc3NhZ2UgPSBudWxsOyB9XG5cdCAgICAgICAgaWYgKCFtZXNzYWdlKSB7XG5cdCAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIllvdSBjYWxsZWQgbG9hZCB3aXRob3V0IHByb3ZpZGluZyBtZXNzYWdlIHByb3BlcnRpZXMgZnJvbSB0aGUgY29uY3JldGUgZW1iZWRkYWJsZSBjbGFzcy5cIik7XG5cdCAgICAgICAgfVxuXHQgICAgICAgIHZhciBiYXNlTWVzc2FnZSA9IHtcblx0ICAgICAgICAgICAgYWNjZXNzVG9rZW46IG9wdGlvbnMuYWNjZXNzVG9rZW5cblx0ICAgICAgICB9O1xuXHQgICAgICAgIHV0aWxfMS5VdGlscy5hc3NpZ24obWVzc2FnZSwgYmFzZU1lc3NhZ2UpO1xuXHQgICAgICAgIHZhciBldmVudCA9IHtcblx0ICAgICAgICAgICAgbWVzc2FnZTogbWVzc2FnZVxuXHQgICAgICAgIH07XG5cdCAgICAgICAgdXRpbF8xLlV0aWxzLnJhaXNlQ3VzdG9tRXZlbnQodGhpcy5lbGVtZW50LCBldmVudC5tZXNzYWdlLmFjdGlvbiwgZXZlbnQpO1xuXHQgICAgICAgIHRoaXMuaWZyYW1lLmNvbnRlbnRXaW5kb3cucG9zdE1lc3NhZ2UoSlNPTi5zdHJpbmdpZnkoZXZlbnQubWVzc2FnZSksICcqJyk7XG5cdCAgICB9O1xuXHQgICAgLyoqXG5cdCAgICAgKiBHZXQgYWNjZXNzIHRva2VuIGZyb20gZmlyc3QgYXZhaWxhYmxlIGxvY2F0aW9uOiBvcHRpb25zLCBhdHRyaWJ1dGUsIGdsb2JhbC5cblx0ICAgICAqL1xuXHQgICAgRW1iZWQucHJvdG90eXBlLmdldEFjY2Vzc1Rva2VuID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIHZhciBhY2Nlc3NUb2tlbiA9IHRoaXMub3B0aW9ucy5hY2Nlc3NUb2tlbiB8fCB0aGlzLmVsZW1lbnQuZ2V0QXR0cmlidXRlKEVtYmVkLmFjY2Vzc1Rva2VuQXR0cmlidXRlKSB8fCB0aGlzLm9wdGlvbnMuZ2V0R2xvYmFsQWNjZXNzVG9rZW4oKTtcblx0ICAgICAgICBpZiAoIWFjY2Vzc1Rva2VuKSB7XG5cdCAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIk5vIGFjY2VzcyB0b2tlbiB3YXMgZm91bmQgZm9yIGVsZW1lbnQuIFlvdSBtdXN0IHNwZWNpZnkgYW4gYWNjZXNzIHRva2VuIGRpcmVjdGx5IG9uIHRoZSBlbGVtZW50IHVzaW5nIGF0dHJpYnV0ZSAnXCIgKyBFbWJlZC5hY2Nlc3NUb2tlbkF0dHJpYnV0ZSArIFwiJyBvciBzcGVjaWZ5IGEgZ2xvYmFsIHRva2VuIGF0OiBwb3dlcmJpLmFjY2Vzc1Rva2VuLlwiKTtcblx0ICAgICAgICB9XG5cdCAgICAgICAgcmV0dXJuIGFjY2Vzc1Rva2VuO1xuXHQgICAgfTtcblx0ICAgIC8qKlxuXHQgICAgICogR2V0IGVtYmVkIHVybCBmcm9tIGZpcnN0IGF2YWlsYWJsZSBsb2NhdGlvbjogb3B0aW9ucywgYXR0cmlidXRlLlxuXHQgICAgICovXG5cdCAgICBFbWJlZC5wcm90b3R5cGUuZ2V0RW1iZWRVcmwgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgdmFyIGVtYmVkVXJsID0gdGhpcy5vcHRpb25zLmVtYmVkVXJsIHx8IHRoaXMuZWxlbWVudC5nZXRBdHRyaWJ1dGUoRW1iZWQuZW1iZWRVcmxBdHRyaWJ1dGUpO1xuXHQgICAgICAgIGlmICh0eXBlb2YgZW1iZWRVcmwgIT09ICdzdHJpbmcnIHx8IGVtYmVkVXJsLmxlbmd0aCA9PT0gMCkge1xuXHQgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJFbWJlZCBVcmwgaXMgcmVxdWlyZWQsIGJ1dCBpdCB3YXMgbm90IGZvdW5kLiBZb3UgbXVzdCBwcm92aWRlIGFuIGVtYmVkIHVybCBlaXRoZXIgYXMgcGFydCBvZiBlbWJlZCBjb25maWd1cmF0aW9uIG9yIGFzIGF0dHJpYnV0ZSAnXCIgKyBFbWJlZC5lbWJlZFVybEF0dHJpYnV0ZSArIFwiJy5cIik7XG5cdCAgICAgICAgfVxuXHQgICAgICAgIHJldHVybiBlbWJlZFVybDtcblx0ICAgIH07XG5cdCAgICAvKipcblx0ICAgICAqIFJlcXVlc3QgdGhlIGJyb3dzZXIgdG8gbWFrZSB0aGUgY29tcG9uZW50cyBpZnJhbWUgZnVsbHNjcmVlbi5cblx0ICAgICAqL1xuXHQgICAgRW1iZWQucHJvdG90eXBlLmZ1bGxzY3JlZW4gPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgdmFyIHJlcXVlc3RGdWxsU2NyZWVuID0gdGhpcy5pZnJhbWUucmVxdWVzdEZ1bGxzY3JlZW4gfHwgdGhpcy5pZnJhbWUubXNSZXF1ZXN0RnVsbHNjcmVlbiB8fCB0aGlzLmlmcmFtZS5tb3pSZXF1ZXN0RnVsbFNjcmVlbiB8fCB0aGlzLmlmcmFtZS53ZWJraXRSZXF1ZXN0RnVsbHNjcmVlbjtcblx0ICAgICAgICByZXF1ZXN0RnVsbFNjcmVlbi5jYWxsKHRoaXMuaWZyYW1lKTtcblx0ICAgIH07XG5cdCAgICAvKipcblx0ICAgICAqIEV4aXQgZnVsbHNjcmVlbi5cblx0ICAgICAqL1xuXHQgICAgRW1iZWQucHJvdG90eXBlLmV4aXRGdWxsc2NyZWVuID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIGlmICghdGhpcy5pc0Z1bGxzY3JlZW4odGhpcy5pZnJhbWUpKSB7XG5cdCAgICAgICAgICAgIHJldHVybjtcblx0ICAgICAgICB9XG5cdCAgICAgICAgdmFyIGV4aXRGdWxsc2NyZWVuID0gZG9jdW1lbnQuZXhpdEZ1bGxzY3JlZW4gfHwgZG9jdW1lbnQubW96Q2FuY2VsRnVsbFNjcmVlbiB8fCBkb2N1bWVudC53ZWJraXRFeGl0RnVsbHNjcmVlbiB8fCBkb2N1bWVudC5tc0V4aXRGdWxsc2NyZWVuO1xuXHQgICAgICAgIGV4aXRGdWxsc2NyZWVuLmNhbGwoZG9jdW1lbnQpO1xuXHQgICAgfTtcblx0ICAgIC8qKlxuXHQgICAgICogUmV0dXJuIHRydWUgaWYgaWZyYW1lIGlzIGZ1bGxzY3JlZW4sXG5cdCAgICAgKiBvdGhlcndpc2UgcmV0dXJuIGZhbHNlXG5cdCAgICAgKi9cblx0ICAgIEVtYmVkLnByb3RvdHlwZS5pc0Z1bGxzY3JlZW4gPSBmdW5jdGlvbiAoaWZyYW1lKSB7XG5cdCAgICAgICAgdmFyIG9wdGlvbnMgPSBbJ2Z1bGxzY3JlZW5FbGVtZW50JywgJ3dlYmtpdEZ1bGxzY3JlZW5FbGVtZW50JywgJ21vekZ1bGxzY3JlZW5TY3JlZW5FbGVtZW50JywgJ21zRnVsbHNjcmVlbkVsZW1lbnQnXTtcblx0ICAgICAgICByZXR1cm4gb3B0aW9ucy5zb21lKGZ1bmN0aW9uIChvcHRpb24pIHsgcmV0dXJuIGRvY3VtZW50W29wdGlvbl0gPT09IGlmcmFtZTsgfSk7XG5cdCAgICB9O1xuXHQgICAgRW1iZWQuZW1iZWRVcmxBdHRyaWJ1dGUgPSAncG93ZXJiaS1lbWJlZC11cmwnO1xuXHQgICAgRW1iZWQuYWNjZXNzVG9rZW5BdHRyaWJ1dGUgPSAncG93ZXJiaS1hY2Nlc3MtdG9rZW4nO1xuXHQgICAgRW1iZWQudHlwZUF0dHJpYnV0ZSA9ICdwb3dlcmJpLXR5cGUnO1xuXHQgICAgLyoqXG5cdCAgICAgKiBEZWZhdWx0IG9wdGlvbnMgZm9yIGVtYmVkZGFibGUgY29tcG9uZW50LlxuXHQgICAgICovXG5cdCAgICBFbWJlZC5kZWZhdWx0T3B0aW9ucyA9IHtcblx0ICAgICAgICBmaWx0ZXJQYW5lRW5hYmxlZDogdHJ1ZVxuXHQgICAgfTtcblx0ICAgIHJldHVybiBFbWJlZDtcblx0fSgpKTtcblx0ZXhwb3J0cy5FbWJlZCA9IEVtYmVkO1xuXG5cbi8qKiovIH0sXG4vKiAzICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxuXHR2YXIgVXRpbHMgPSAoZnVuY3Rpb24gKCkge1xuXHQgICAgZnVuY3Rpb24gVXRpbHMoKSB7XG5cdCAgICB9XG5cdCAgICBVdGlscy5yYWlzZUN1c3RvbUV2ZW50ID0gZnVuY3Rpb24gKGVsZW1lbnQsIGV2ZW50TmFtZSwgZXZlbnREYXRhKSB7XG5cdCAgICAgICAgdmFyIGN1c3RvbUV2ZW50O1xuXHQgICAgICAgIGlmICh0eXBlb2YgQ3VzdG9tRXZlbnQgPT09ICdmdW5jdGlvbicpIHtcblx0ICAgICAgICAgICAgY3VzdG9tRXZlbnQgPSBuZXcgQ3VzdG9tRXZlbnQoZXZlbnROYW1lLCB7XG5cdCAgICAgICAgICAgICAgICBkZXRhaWw6IGV2ZW50RGF0YSxcblx0ICAgICAgICAgICAgICAgIGJ1YmJsZXM6IHRydWUsXG5cdCAgICAgICAgICAgICAgICBjYW5jZWxhYmxlOiB0cnVlXG5cdCAgICAgICAgICAgIH0pO1xuXHQgICAgICAgIH1cblx0ICAgICAgICBlbHNlIHtcblx0ICAgICAgICAgICAgY3VzdG9tRXZlbnQgPSBkb2N1bWVudC5jcmVhdGVFdmVudCgnQ3VzdG9tRXZlbnQnKTtcblx0ICAgICAgICAgICAgY3VzdG9tRXZlbnQuaW5pdEN1c3RvbUV2ZW50KGV2ZW50TmFtZSwgdHJ1ZSwgdHJ1ZSwgZXZlbnREYXRhKTtcblx0ICAgICAgICB9XG5cdCAgICAgICAgZWxlbWVudC5kaXNwYXRjaEV2ZW50KGN1c3RvbUV2ZW50KTtcblx0ICAgICAgICBpZiAoY3VzdG9tRXZlbnQuZGVmYXVsdFByZXZlbnRlZCB8fCAhY3VzdG9tRXZlbnQucmV0dXJuVmFsdWUpIHtcblx0ICAgICAgICAgICAgcmV0dXJuO1xuXHQgICAgICAgIH1cblx0ICAgICAgICAvLyBUT0RPOiBSZW1vdmUgdGhpcz8gU2hvdWxkIGJlIGJldHRlciB3YXkgdG8gaGFuZGxlIGV2ZW50cyB0aGFuIHVzaW5nIGV2YWw/XG5cdCAgICAgICAgLy8gV2hhdCBpcyB1c2UgY2FzZT8gPGRpdiBwb3dlcmJpLXR5cGU9XCJyZXBvcnRcIiBvbmxvYWQ9XCJhbGVydCgnbG9hZGVkJyk7XCI+PC9kaXY+XG5cdCAgICAgICAgdmFyIGlubGluZUV2ZW50QXR0ciA9ICdvbicgKyBldmVudE5hbWUucmVwbGFjZSgnLScsICcnKTtcblx0ICAgICAgICB2YXIgaW5saW5lU2NyaXB0ID0gZWxlbWVudC5nZXRBdHRyaWJ1dGUoaW5saW5lRXZlbnRBdHRyKTtcblx0ICAgICAgICBpZiAoaW5saW5lU2NyaXB0KSB7XG5cdCAgICAgICAgICAgIGV2YWwuY2FsbChlbGVtZW50LCBpbmxpbmVTY3JpcHQpO1xuXHQgICAgICAgIH1cblx0ICAgIH07XG5cdCAgICBVdGlscy5maW5kSW5kZXggPSBmdW5jdGlvbiAocHJlZGljYXRlLCB4cykge1xuXHQgICAgICAgIGlmICghQXJyYXkuaXNBcnJheSh4cykpIHtcblx0ICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiWW91IGF0dGVtcHRlZCB0byBjYWxsIGZpbmQgd2l0aCBzZWNvbmQgcGFyYW1ldGVyIHRoYXQgd2FzIG5vdCBhbiBhcnJheS4gWW91IHBhc3NlZDogXCIgKyB4cyk7XG5cdCAgICAgICAgfVxuXHQgICAgICAgIHZhciBpbmRleDtcblx0ICAgICAgICB4cy5zb21lKGZ1bmN0aW9uICh4LCBpKSB7XG5cdCAgICAgICAgICAgIGlmIChwcmVkaWNhdGUoeCkpIHtcblx0ICAgICAgICAgICAgICAgIGluZGV4ID0gaTtcblx0ICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgfSk7XG5cdCAgICAgICAgcmV0dXJuIGluZGV4O1xuXHQgICAgfTtcblx0ICAgIFV0aWxzLmZpbmQgPSBmdW5jdGlvbiAocHJlZGljYXRlLCB4cykge1xuXHQgICAgICAgIHZhciBpbmRleCA9IFV0aWxzLmZpbmRJbmRleChwcmVkaWNhdGUsIHhzKTtcblx0ICAgICAgICByZXR1cm4geHNbaW5kZXhdO1xuXHQgICAgfTtcblx0ICAgIFV0aWxzLnJlbW92ZSA9IGZ1bmN0aW9uIChwcmVkaWNhdGUsIHhzKSB7XG5cdCAgICAgICAgdmFyIGluZGV4ID0gVXRpbHMuZmluZEluZGV4KHByZWRpY2F0ZSwgeHMpO1xuXHQgICAgICAgIHhzLnNwbGljZShpbmRleCwgMSk7XG5cdCAgICB9O1xuXHQgICAgLy8gU2VlOiBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9KYXZhU2NyaXB0L1JlZmVyZW5jZS9HbG9iYWxfT2JqZWN0cy9PYmplY3QvYXNzaWduXG5cdCAgICAvLyBUT0RPOiByZXBsYWNlIGluIGZhdm9yIG9mIHVzaW5nIHBvbHlmaWxsXG5cdCAgICBVdGlscy5hc3NpZ24gPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgdmFyIGFyZ3MgPSBbXTtcblx0ICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuXHQgICAgICAgICAgICBhcmdzW19pIC0gMF0gPSBhcmd1bWVudHNbX2ldO1xuXHQgICAgICAgIH1cblx0ICAgICAgICB2YXIgdGFyZ2V0ID0gYXJnc1swXTtcblx0ICAgICAgICAndXNlIHN0cmljdCc7XG5cdCAgICAgICAgaWYgKHRhcmdldCA9PT0gdW5kZWZpbmVkIHx8IHRhcmdldCA9PT0gbnVsbCkge1xuXHQgICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdDYW5ub3QgY29udmVydCB1bmRlZmluZWQgb3IgbnVsbCB0byBvYmplY3QnKTtcblx0ICAgICAgICB9XG5cdCAgICAgICAgdmFyIG91dHB1dCA9IE9iamVjdCh0YXJnZXQpO1xuXHQgICAgICAgIGZvciAodmFyIGluZGV4ID0gMTsgaW5kZXggPCBhcmd1bWVudHMubGVuZ3RoOyBpbmRleCsrKSB7XG5cdCAgICAgICAgICAgIHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaW5kZXhdO1xuXHQgICAgICAgICAgICBpZiAoc291cmNlICE9PSB1bmRlZmluZWQgJiYgc291cmNlICE9PSBudWxsKSB7XG5cdCAgICAgICAgICAgICAgICBmb3IgKHZhciBuZXh0S2V5IGluIHNvdXJjZSkge1xuXHQgICAgICAgICAgICAgICAgICAgIGlmIChzb3VyY2UuaGFzT3duUHJvcGVydHkobmV4dEtleSkpIHtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgb3V0cHV0W25leHRLZXldID0gc291cmNlW25leHRLZXldO1xuXHQgICAgICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgIH1cblx0ICAgICAgICByZXR1cm4gb3V0cHV0O1xuXHQgICAgfTtcblx0ICAgIHJldHVybiBVdGlscztcblx0fSgpKTtcblx0ZXhwb3J0cy5VdGlscyA9IFV0aWxzO1xuXG5cbi8qKiovIH0sXG4vKiA0ICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHR2YXIgX19leHRlbmRzID0gKHRoaXMgJiYgdGhpcy5fX2V4dGVuZHMpIHx8IGZ1bmN0aW9uIChkLCBiKSB7XG5cdCAgICBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTtcblx0ICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxuXHQgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xuXHR9O1xuXHR2YXIgZW1iZWRfMSA9IF9fd2VicGFja19yZXF1aXJlX18oMik7XG5cdHZhciBSZXBvcnQgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuXHQgICAgX19leHRlbmRzKFJlcG9ydCwgX3N1cGVyKTtcblx0ICAgIGZ1bmN0aW9uIFJlcG9ydCgpIHtcblx0ICAgICAgICBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblx0ICAgIH1cblx0ICAgIFJlcG9ydC5wcm90b3R5cGUuZ2V0RW1iZWRVcmwgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgdmFyIGVtYmVkVXJsID0gX3N1cGVyLnByb3RvdHlwZS5nZXRFbWJlZFVybC5jYWxsKHRoaXMpO1xuXHQgICAgICAgIC8vIFRPRE86IE5lZWQgc2FmZSB3YXkgdG8gYWRkIHVybCBwYXJhbWV0ZXJzLlxuXHQgICAgICAgIC8vIFdlIGFyZSBhc3N1bWluZyBlbWJlZFVybHMgdXNlIHF1ZXJ5IHBhcmFtZXRlcnMgdG8gc3VwcGx5IGlkIG9mIHZpc3VhbFxuXHQgICAgICAgIC8vIHNvIG11c3QgcHJlZml4IHdpdGggJyYnLlxuXHQgICAgICAgIGlmICghdGhpcy5vcHRpb25zLmZpbHRlclBhbmVFbmFibGVkKSB7XG5cdCAgICAgICAgICAgIGVtYmVkVXJsICs9IFwiJmZpbHRlclBhbmVFbmFibGVkPWZhbHNlXCI7XG5cdCAgICAgICAgfVxuXHQgICAgICAgIHJldHVybiBlbWJlZFVybDtcblx0ICAgIH07XG5cdCAgICBSZXBvcnQucHJvdG90eXBlLmxvYWQgPSBmdW5jdGlvbiAob3B0aW9ucywgcmVxdWlyZUlkKSB7XG5cdCAgICAgICAgaWYgKHJlcXVpcmVJZCA9PT0gdm9pZCAwKSB7IHJlcXVpcmVJZCA9IGZhbHNlOyB9XG5cdCAgICAgICAgaWYgKHJlcXVpcmVJZCAmJiB0eXBlb2Ygb3B0aW9ucy5pZCAhPT0gJ3N0cmluZycpIHtcblx0ICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiaWQgbXVzdCBiZSBzcGVjaWZpZWQgd2hlbiBsb2FkaW5nIHJlcG9ydHMgb24gZXhpc3RpbmcgZWxlbWVudHMuXCIpO1xuXHQgICAgICAgIH1cblx0ICAgICAgICB2YXIgbWVzc2FnZSA9IHtcblx0ICAgICAgICAgICAgYWN0aW9uOiAnbG9hZFJlcG9ydCcsXG5cdCAgICAgICAgICAgIHJlcG9ydElkOiBvcHRpb25zLmlkLFxuXHQgICAgICAgICAgICBhY2Nlc3NUb2tlbjogbnVsbFxuXHQgICAgICAgIH07XG5cdCAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5sb2FkLmNhbGwodGhpcywgb3B0aW9ucywgcmVxdWlyZUlkLCBtZXNzYWdlKTtcblx0ICAgIH07XG5cdCAgICBSZXBvcnQubmFtZSA9IFwiUmVwb3J0XCI7XG5cdCAgICByZXR1cm4gUmVwb3J0O1xuXHR9KGVtYmVkXzEuRW1iZWQpKTtcblx0ZXhwb3J0cy5SZXBvcnQgPSBSZXBvcnQ7XG5cblxuLyoqKi8gfSxcbi8qIDUgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdHZhciBfX2V4dGVuZHMgPSAodGhpcyAmJiB0aGlzLl9fZXh0ZW5kcykgfHwgZnVuY3Rpb24gKGQsIGIpIHtcblx0ICAgIGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdO1xuXHQgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XG5cdCAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XG5cdH07XG5cdHZhciBlbWJlZF8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKTtcblx0dmFyIFRpbGUgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuXHQgICAgX19leHRlbmRzKFRpbGUsIF9zdXBlcik7XG5cdCAgICBmdW5jdGlvbiBUaWxlKCkge1xuXHQgICAgICAgIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHQgICAgfVxuXHQgICAgVGlsZS5wcm90b3R5cGUuZ2V0RW1iZWRVcmwgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgdmFyIGVtYmVkVXJsID0gX3N1cGVyLnByb3RvdHlwZS5nZXRFbWJlZFVybC5jYWxsKHRoaXMpO1xuXHQgICAgICAgIHJldHVybiBlbWJlZFVybDtcblx0ICAgIH07XG5cdCAgICBUaWxlLnByb3RvdHlwZS5sb2FkID0gZnVuY3Rpb24gKG9wdGlvbnMsIHJlcXVpcmVJZCkge1xuXHQgICAgICAgIGlmIChyZXF1aXJlSWQgPT09IHZvaWQgMCkgeyByZXF1aXJlSWQgPSBmYWxzZTsgfVxuXHQgICAgICAgIGlmIChyZXF1aXJlSWQgJiYgdHlwZW9mIG9wdGlvbnMuaWQgIT09ICdzdHJpbmcnKSB7XG5cdCAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcImlkIG11c3QgYmUgc3BlY2lmaWVkIHdoZW4gbG9hZGluZyByZXBvcnRzIG9uIGV4aXN0aW5nIGVsZW1lbnRzLlwiKTtcblx0ICAgICAgICB9XG5cdCAgICAgICAgdmFyIG1lc3NhZ2UgPSB7XG5cdCAgICAgICAgICAgIGFjdGlvbjogJ2xvYWRUaWxlJyxcblx0ICAgICAgICAgICAgdGlsZUlkOiBvcHRpb25zLmlkLFxuXHQgICAgICAgICAgICBhY2Nlc3NUb2tlbjogbnVsbFxuXHQgICAgICAgIH07XG5cdCAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5sb2FkLmNhbGwodGhpcywgb3B0aW9ucywgcmVxdWlyZUlkLCBtZXNzYWdlKTtcblx0ICAgIH07XG5cdCAgICBUaWxlLm5hbWUgPSBcIlRpbGVcIjtcblx0ICAgIHJldHVybiBUaWxlO1xuXHR9KGVtYmVkXzEuRW1iZWQpKTtcblx0ZXhwb3J0cy5UaWxlID0gVGlsZTtcblxuXG4vKioqLyB9XG4vKioqKioqLyBdKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXBvd2VyYmkuanMubWFwIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
